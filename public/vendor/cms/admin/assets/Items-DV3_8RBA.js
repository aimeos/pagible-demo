import{l as y}from"./vue-draggable-plus-bJe6xj70.js";import{_ as k,c as n,a as u,d as V,f as c,w as r,ab as C,F as f,a3 as p,b as v,h as _,r as F,o as l,ac as B,ad as N,t as b,ae as j,af as w,k as D,ag as E}from"../index.js";const U={components:{VueDraggable:y},props:{modelValue:{type:Array,default:()=>[]},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","error","addFile","removeFile"],data(){return{errors:[],items:[],panel:[]}},methods:{add(){this.items.push({}),this.panel.push(this.items.length-1),this.$emit("update:modelValue",this.items),this.validate()},change(){this.$emit("update:modelValue",this.items)},remove(t){this.items.splice(t,1),this.$emit("update:modelValue",this.items),this.validate()},title(t){return Object.values(t||{}).map(e=>e&&typeof e!="object"&&typeof e!="boolean"?e:null).filter(e=>!!e).join(" - ").substring(0,50)||""},toName(t){var e;return((e=t==null?void 0:t.charAt(0))==null?void 0:e.toUpperCase())+(t==null?void 0:t.slice(1))},async validate(){const t=[e=>!this.config.max||this.config.max&&e.length<=this.config.max||this.$gettext("Maximum is %{num} entries",{num:this.config.max}),e=>(this.config.min??1)&&e.length>=(this.config.min??1)||this.$gettext("Minimum is %{num} entries",{num:this.config.min??1})];return this.errors=t.map(e=>e(this.items)).filter(e=>e!==!0),this.$emit("error",this.errors.length>0),await!this.errors.length}},watch:{modelValue:{immediate:!0,handler(t){this.items=t,this.validate()}}}},A={class:"element-title"},P={key:0,class:"v-input--error"},O={class:"v-input__details",role:"alert","aria-live":"polite"},T={class:"v-messages"},I={class:"btn-group"};function L(t,e,a,M,s,m){const x=F("VueDraggable");return l(),n(f,null,[u(C,{class:"items",modelValue:s.panel,"onUpdate:modelValue":e[4]||(e[4]=i=>s.panel=i),elevation:"0",multiple:""},{default:r(()=>[u(x,{modelValue:s.items,"onUpdate:modelValue":e[2]||(e[2]=i=>s.items=i),disabled:a.readonly,onChange:e[3]||(e[3]=i=>m.change()),draggable:".item",group:"items",animation:"500"},{default:r(()=>[(l(!0),n(f,null,p(s.items,(i,o)=>(l(),v(B,{key:o,class:"item"},{default:r(()=>[u(N,null,{default:r(()=>[a.readonly?V("",!0):(l(),v(_,{key:0,onClick:g=>m.remove(o),title:t.$gettext("Remove element"),icon:"mdi-trash-can",variant:"plain"},null,8,["onClick","title"])),c("div",A,b(m.title(i)),1)]),_:2},1024),u(j,null,{default:r(()=>[(l(!0),n(f,null,p(a.config.item||{},(g,h)=>(l(),n("div",{key:h,class:"field"},[u(w,null,{default:r(()=>[D(b(g.label||h),1)]),_:2},1024),(l(),v(E(m.toName(g.type)),{modelValue:s.items[o][h],"onUpdate:modelValue":d=>s.items[o][h]=d,onAddFile:e[0]||(e[0]=d=>t.$emit("addFile",d)),onRemoveFile:e[1]||(e[1]=d=>t.$emit("removeFile",d)),readonly:a.readonly,assets:a.assets,config:g},null,40,["modelValue","onUpdate:modelValue","readonly","assets","config"]))]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue"]),s.errors.length?(l(),n("div",P,[c("div",O,[c("div",T,[(l(!0),n(f,null,p(s.errors,(i,o)=>(l(),n("div",{key:o,class:"v-messages__message"},b(i),1))),128))])])])):V("",!0),c("div",I,[!a.readonly&&(!a.config.max||a.config.max&&+s.items.length<+a.config.max)?(l(),v(_,{key:0,title:t.$gettext("Add element"),icon:"mdi-view-grid-plus",onClick:e[5]||(e[5]=i=>m.add())},null,8,["title"])):V("",!0)])],64)}const q=k(U,[["render",L],["__scopeId","data-v-bd67afed"]]);export{q as default};
