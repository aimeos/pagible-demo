import{u as J,N as K,O as _,s as ne,P as le,Q as re,v as E,x as L,R as N,y as I,S as oe,U as ue,z as ie,W as de,A as j,B as se,C as ce,D as fe,X as me,Y as ve,G as T,Z as Y,I as q,a as S,m as $,$ as ye,f as pe,h as he,F as Ve,_ as ge,b as De,r as Pe,o as Fe}from"./index-zamkCzJL.js";class D{constructor(n,a){this.order=n,this.separator=a}get format(){return this.order.split("").map(n=>`${n}${n}`).join(this.separator).replace("yy","yyyy")}static canBeParsed(n){if(typeof n!="string")return!1;const a=n.toLowerCase();return["y","m","d"].every(r=>a.includes(r))&&["/","-","."].some(r=>n.includes(r))}static parse(n){if(!D.canBeParsed(n))throw new Error(`[${n}] cannot be parsed into date format specification`);const a=n.toLowerCase().split("").filter((u,p,l)=>"dmy".includes(u)&&l.indexOf(u)===p).join(""),r=["/","-","."].find(u=>n.includes(u));return new D(a,r)}}const xe=J({inputFormat:{type:String,validator:e=>!e||D.canBeParsed(e)}},"date-format");function ke(e,n){const a=K();function r(){const f=n.value??"en-US",V=Intl.DateTimeFormat(f,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a.toJsDate(a.parseISO("1999-12-07"))).replace(/(07)|(٠٧)|(٢٩)|(۱۶)|(০৭)/,"dd").replace(/(12)|(١٢)|(٠٨)|(۰۹)|(১২)/,"mm").replace(/(1999)|(2542)|(١٩٩٩)|(١٤٢٠)|(۱۳۷۸)|(১৯৯৯)/,"yyyy").replace(/[^ymd\-/.]/g,"").replace(/\.$/,"");return D.canBeParsed(V)?V:"mm/dd/yyyy"}const u=_(()=>D.canBeParsed(e.inputFormat)?D.parse(e.inputFormat):D.parse(r()));function p(f){function V(i){const s=i.trim().split(u.value.separator);return{y:Number(s[u.value.order.indexOf("y")]),m:Number(s[u.value.order.indexOf("m")]),d:Number(s[u.value.order.indexOf("d")])}}function b(i){const{y:s,m:y,d:k}=i;return!s||!y||!k||y<1||y>12||k<1||k>31?null:{year:x(s),month:y,day:k}}function x(i){const s=a.getYear(a.date());if(i>100||s%100>=50)return i;const y=~~(s/100)*100;return i<50?y+i:y-100+i}const O=V(f),o=b(O);if(!o)return null;const{year:d,month:v,day:P}=o,C=i=>String(i).padStart(2,"0");return a.parseISO(`${d}-${C(v)}-${C(P)}`)}function l(f){return!!p(f)}function h(f){const V=a.toISO(f).split("T")[0].split("-");return u.value.order.split("").map(b=>V["ymd".indexOf(b)]).join(u.value.separator)}return{isValid:l,parseDate:p,formatDate:h,parserFormat:_(()=>u.value.format)}}const we=J({displayFormat:{type:[Function,String],default:void 0},location:{type:String,default:"bottom start"},menu:Boolean,updateOn:{type:Array,default:()=>["blur","enter"]},...xe(),...me({mobile:null}),...fe(),...ce({hideActions:!0}),...se({prependIcon:"$calendar"}),...j(ve({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),be=ne()({name:"VDateInput",props:we(),emits:{save:e=>!0,cancel:()=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{emit:a,slots:r}=n;const{t:u,current:p}=le(),l=K(),{isValid:h,parseDate:f,formatDate:V,parserFormat:b}=ke(e,p),{mobile:x}=re(e),O=()=>e.multiple?[]:null,o=E(e,"modelValue",O(),t=>Array.isArray(t)?t.map(c=>l.toJsDate(c)):t&&l.toJsDate(t),t=>Array.isArray(t)?t.map(c=>l.date(c)):t&&l.date(t)),d=E(e,"menu"),v=L(!1),P=L(e.focused),C=N(),i=N(["save"]);function s(t){return typeof e.displayFormat=="function"?e.displayFormat(t):e.displayFormat?l.format(t,e.displayFormat??"keyboardDate"):V(t)}const y=I(()=>{const t=oe(o.value);if(!t.length)return null;if(e.multiple===!0)return u("$vuetify.datePicker.itemsSelected",t.length);if(e.multiple==="range"){const c=t[0],g=t[t.length-1];return!l.isValid(c)||!l.isValid(g)?"":`${s(l.date(c))} - ${s(l.date(g))}`}return l.isValid(o.value)?s(l.date(o.value)):""}),k=I(()=>{if(x.value)return v.value?"text":"none"}),B=I(()=>!e.disabled&&!e.readonly),W=I(()=>e.updateOn.length?!(x.value&&v.value)&&e.readonly:!0);ue(d,t=>{t||(v.value=!1,i.value=["save"])});function z(t){t.key==="Enter"&&((!d.value||!P.value)&&(d.value=!0),e.updateOn.includes("enter")&&R(t.target))}function M(t){t.preventDefault(),t.stopPropagation(),d.value&&x.value?v.value=!0:d.value=!0}function G(){a("cancel"),d.value=!1,v.value=!1}function H(t){a("save",t),d.value=!1}function Q(t){t==null&&(o.value=O())}function X(t){e.updateOn.includes("blur")&&R(t.target),x.value&&v.value&&!P.value&&(d.value=!1,v.value=!1)}function R(t){let{value:c}=t;if(!c.trim())o.value=O();else if(!e.multiple)h(c)&&(o.value=f(c));else{const g=c.trim().split(/\D+-\D+|[^\d\-/.]+/);if(g.every(h))if(e.multiple==="range"){const[w,F]=g.map(f).toSorted((U,A)=>l.isAfter(U,A)?1:-1);o.value=ye(l,w,F)}else o.value=g.map(f)}}return ie(()=>{const t=T.filterProps(e),c=Y.filterProps(j(e,["active","location","rounded"])),g=q.filterProps(j(e,["placeholder"]));return S(q,$({ref:C},g,{class:e.class,style:e.style,modelValue:y.value,inputmode:k.value,placeholder:e.placeholder??b.value,readonly:W.value,onKeydown:B.value?z:void 0,focused:d.value||P.value,onBlur:X,validationValue:o.value,"onClick:control":B.value?M:void 0,"onClick:prepend":B.value?M:void 0,"onUpdate:modelValue":Q,"onUpdate:focused":w=>P.value=w}),{...r,default:()=>{var w;return pe(Ve,null,[S(he,{modelValue:d.value,"onUpdate:modelValue":F=>d.value=F,activator:"parent",minWidth:"0",eager:P.value,location:e.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[S(T,$(t,{modelValue:o.value,"onUpdate:modelValue":F=>o.value=F,disabled:i.value,onSave:H,onCancel:G}),{default:F=>{let{actions:U,model:A,save:Z,cancel:ee,isPristine:te}=F;function ae(m){e.hideActions?(o.value=m,e.multiple||(d.value=!1)):A.value=m,a("save",m),i.value=[]}return S(Y,$(c,{modelValue:e.hideActions?o.value:A.value,"onUpdate:modelValue":m=>ae(m),onMousedown:m=>m.preventDefault()}),{actions:e.hideActions?void 0:()=>{var m;return((m=r.actions)==null?void 0:m.call(r,{save:Z,cancel:ee,isPristine:te}))??U()}})}})]}),(w=r.default)==null?void 0:w.call(r)])}})}),de({},C)}}),Oe={components:{VDateInput:be},props:{modelValue:{type:[Array,Date,String,null],default:null},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1},context:{type:Object}},emits:["update:modelValue","error"],methods:{update(e){this.$emit("update:modelValue",e),this.validate()},async validate(){var n;await this.$nextTick();const e=await((n=this.$refs.field)==null?void 0:n.validate());return this.$emit("error",(e==null?void 0:e.length)>0),!(e!=null&&e.length)}},watch:{modelValue:{immediate:!0,handler(e){this.validate()}}}};function Ce(e,n,a,r,u,p){const l=Pe("v-date-input");return Fe(),De(l,{ref:"field",rules:[h=>!a.config.required||!!h||e.$gettext("Value is required")],readonly:a.readonly,"allowed-dates":a.config.allowed,clearable:!a.readonly&&!a.config.required,max:a.config.max,min:a.config.min,multiple:a.config.multiple,placeholder:a.config.placeholder||null,modelValue:a.modelValue,"onUpdate:modelValue":n[0]||(n[0]=h=>p.update(h)),density:"comfortable","hide-details":"auto",variant:"outlined","show-adjacent-months":""},null,8,["rules","readonly","allowed-dates","clearable","max","min","multiple","placeholder","modelValue"])}const Ie=ge(Oe,[["render",Ce]]);export{Ie as default};
