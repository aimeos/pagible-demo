import{p as J,M as H,N as j,m as ne,O as le,P as re,u as E,s as L,Q as N,q as I,R as oe,S as ue,v as ie,U as de,x as M,y as se,z as ce,A as fe,W as me,X as ve,C as T,Y as q,E as Y,a as S,H as $,Z as ye,f as pe,I as he,F as Ve,_ as ge,b as Pe,r as De,o as Fe}from"../index.js";class P{constructor(n,a){this.order=n,this.separator=a}get format(){return this.order.split("").map(n=>`${n}${n}`).join(this.separator).replace("yy","yyyy")}static canBeParsed(n){if(typeof n!="string")return!1;const a=n.toLowerCase();return["y","m","d"].every(r=>a.includes(r))&&["/","-","."].some(r=>n.includes(r))}static parse(n){if(!P.canBeParsed(n))throw new Error(`[${n}] cannot be parsed into date format specification`);const a=n.toLowerCase().split("").filter((u,p,l)=>"dmy".includes(u)&&l.indexOf(u)===p).join(""),r=["/","-","."].find(u=>n.includes(u));return new P(a,r)}}const ke=J({inputFormat:{type:String,validator:e=>!e||P.canBeParsed(e)}},"date-format");function we(e,n){const a=H();function r(){const f=n.value??"en-US",V=Intl.DateTimeFormat(f,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a.toJsDate(a.parseISO("1999-12-07"))).replace(/(07)|(٠٧)|(٢٩)|(۱۶)|(০৭)/,"dd").replace(/(12)|(١٢)|(٠٨)|(۰۹)|(১২)/,"mm").replace(/(1999)|(2542)|(١٩٩٩)|(١٤٢٠)|(۱۳۷۸)|(১৯৯৯)/,"yyyy").replace(/[^ymd\-/.]/g,"").replace(/\.$/,"");return P.canBeParsed(V)?V:"mm/dd/yyyy"}const u=j(()=>P.canBeParsed(e.inputFormat)?P.parse(e.inputFormat):P.parse(r()));function p(f){function V(i){const s=i.trim().split(u.value.separator);return{y:Number(s[u.value.order.indexOf("y")]),m:Number(s[u.value.order.indexOf("m")]),d:Number(s[u.value.order.indexOf("d")])}}function b(i){const{y:s,m:y,d:w}=i;return!s||!y||!w||y<1||y>12||w<1||w>31?null:{year:k(s),month:y,day:w}}function k(i){const s=a.getYear(a.date());if(i>100||s%100>=50)return i;const y=~~(s/100)*100;return i<50?y+i:y-100+i}const O=V(f),o=b(O);if(!o)return null;const{year:d,month:v,day:D}=o,C=i=>String(i).padStart(2,"0");return a.parseISO(`${d}-${C(v)}-${C(D)}`)}function l(f){return!!p(f)}function h(f){const V=a.toISO(f).split("T")[0].split("-");return u.value.order.split("").map(b=>V["ymd".indexOf(b)]).join(u.value.separator)}return{isValid:l,parseDate:p,formatDate:h,parserFormat:j(()=>u.value.format)}}const xe=J({displayFormat:{type:[Function,String],default:void 0},location:{type:String,default:"bottom start"},menu:Boolean,updateOn:{type:Array,default:()=>["blur","enter"]},...ke(),...me({mobile:null}),...fe(),...ce({hideActions:!0}),...se({prependIcon:"$calendar"}),...M(ve({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),be=ne()({name:"VDateInput",props:xe(),emits:{save:e=>!0,cancel:()=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{emit:a,slots:r}=n;const{t:u,current:p}=le(),l=H(),{isValid:h,parseDate:f,formatDate:V,parserFormat:b}=we(e,p),{mobile:k}=re(e),O=()=>e.multiple?[]:null,o=E(e,"modelValue",O(),t=>Array.isArray(t)?t.map(c=>l.toJsDate(c)):t&&l.toJsDate(t),t=>Array.isArray(t)?t.map(c=>l.date(c)):t&&l.date(t)),d=E(e,"menu"),v=L(!1),D=L(e.focused),C=N(),i=N(["save"]);function s(t){return typeof e.displayFormat=="function"?e.displayFormat(t):e.displayFormat?l.format(t,e.displayFormat??"keyboardDate"):V(t)}const y=I(()=>{const t=oe(o.value);if(!t.length)return null;if(e.multiple===!0)return u("$vuetify.datePicker.itemsSelected",t.length);if(e.multiple==="range"){const c=t[0],g=t[t.length-1];return!l.isValid(c)||!l.isValid(g)?"":`${s(l.date(c))} - ${s(l.date(g))}`}return l.isValid(o.value)?s(l.date(o.value)):""}),w=I(()=>{if(k.value)return v.value?"text":"none"}),B=I(()=>!e.disabled&&!e.readonly),K=I(()=>e.updateOn.length?!(k.value&&v.value)&&e.readonly:!0);ue(d,t=>{t||(v.value=!1,i.value=["save"])});function W(t){t.key==="Enter"&&((!d.value||!D.value)&&(d.value=!0),e.updateOn.includes("enter")&&_(t.target))}function R(t){t.preventDefault(),t.stopPropagation(),d.value&&k.value?v.value=!0:d.value=!0}function z(){a("cancel"),d.value=!1,v.value=!1}function Q(t){a("save",t),d.value=!1}function X(t){t==null&&(o.value=O())}function Z(t){e.updateOn.includes("blur")&&_(t.target),k.value&&v.value&&!D.value&&(d.value=!1,v.value=!1)}function _(t){let{value:c}=t;if(!c.trim())o.value=O();else if(!e.multiple)h(c)&&(o.value=f(c));else{const g=c.trim().split(/\D+-\D+|[^\d\-/.]+/);if(g.every(h))if(e.multiple==="range"){const[x,F]=g.map(f).toSorted((U,A)=>l.isAfter(U,A)?1:-1);o.value=ye(l,x,F)}else o.value=g.map(f)}}return ie(()=>{const t=T.filterProps(e),c=q.filterProps(M(e,["active","location","rounded"])),g=Y.filterProps(M(e,["placeholder"]));return S(Y,$({ref:C},g,{class:e.class,style:e.style,modelValue:y.value,inputmode:w.value,placeholder:e.placeholder??b.value,readonly:K.value,onKeydown:B.value?W:void 0,focused:d.value||D.value,onBlur:Z,validationValue:o.value,"onClick:control":B.value?R:void 0,"onClick:prepend":B.value?R:void 0,"onUpdate:modelValue":X,"onUpdate:focused":x=>D.value=x}),{...r,default:()=>{var x;return pe(Ve,null,[S(he,{modelValue:d.value,"onUpdate:modelValue":F=>d.value=F,activator:"parent",minWidth:"0",eager:D.value,location:e.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[S(T,$(t,{modelValue:o.value,"onUpdate:modelValue":F=>o.value=F,disabled:i.value,onSave:Q,onCancel:z}),{default:F=>{let{actions:U,model:A,save:G,cancel:ee,isPristine:te}=F;function ae(m){e.hideActions?(o.value=m,e.multiple||(d.value=!1)):A.value=m,a("save",m),i.value=[]}return S(q,$(c,{modelValue:e.hideActions?o.value:A.value,"onUpdate:modelValue":m=>ae(m),onMousedown:m=>m.preventDefault()}),{actions:e.hideActions?void 0:()=>{var m;return((m=r.actions)==null?void 0:m.call(r,{save:G,cancel:ee,isPristine:te}))??U()}})}})]}),(x=r.default)==null?void 0:x.call(r)])}})}),de({},C)}}),Oe={components:{VDateInput:be},props:{modelValue:{type:[Array,Date,String,null],default:null},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","error"],methods:{update(e){this.$emit("update:modelValue",e),this.validate()},async validate(){var n;await this.$nextTick();const e=await((n=this.$refs.field)==null?void 0:n.validate());return this.$emit("error",(e==null?void 0:e.length)>0),!(e!=null&&e.length)}},watch:{modelValue:{immediate:!0,handler(e){this.validate()}}}};function Ce(e,n,a,r,u,p){const l=De("v-date-input");return Fe(),Pe(l,{ref:"field",rules:[h=>!a.config.required||!!h||e.$gettext("Value is required")],readonly:a.readonly,"allowed-dates":a.config.allowed,clearable:!a.readonly&&!a.config.required,max:a.config.max,min:a.config.min,multiple:a.config.multiple,placeholder:a.config.placeholder||null,modelValue:a.modelValue,"onUpdate:modelValue":n[0]||(n[0]=h=>p.update(h)),density:"comfortable","hide-details":"auto",variant:"outlined","show-adjacent-months":""},null,8,["rules","readonly","allowed-dates","clearable","max","min","multiple","placeholder","modelValue"])}const Ie=ge(Oe,[["render",Ce]]);export{Ie as default};
