import{_ as de,aF as ce,b as L,w as s,aP as me,o as p,a as m,a9 as ve,aQ as he,c as _,F as B,a3 as J,aa as te,f as D,aR as pe,k as w,t as g,aS as ge,aT as we,a4 as ye,a5 as H,ax as Ce,a6 as Z,aU as Te,d as Y,aV as q,aW as ne,n as O,aX as re,h as G,i as ae,aY as Ve}from"../index.js";const $e={props:{item:{type:Object,required:!0}},setup(){return{drawer:ce()}},computed:{values(){const t={};return this.item.id&&(t[this.$gettext("id")]=this.item.id),this.item.mime&&(t[this.$gettext("mime")]=this.item.mime),this.item.editor&&(t[this.$gettext("editor")]=this.item.editor),this.item.created_at&&(t[this.$gettext("created")]=new Date(this.item.created_at).toLocaleString(this.$vuetify.locale.current)),this.item.updated_at&&(t[this.$gettext("updated")]=new Date(this.item.updated_at).toLocaleString(this.$vuetify.locale.current)),this.item.deleted_at&&(t[this.$gettext("deleted")]=new Date(this.item.deleted_at).toLocaleString(this.$vuetify.locale.current)),t}}};function De(t,e,n,a,l,r){return p(),L(me,{modelValue:a.drawer.aside,"onUpdate:modelValue":e[0]||(e[0]=i=>a.drawer.aside=i),"mobile-breakpoint":"md",location:"end"},{default:s(()=>[m(ve,{opened:[0]},{default:s(()=>[m(he,{value:0},{activator:s(({props:i})=>[m(te,ge(we(i)),{default:s(()=>[w(g(t.$gettext("Meta data")),1)]),_:2},1040)]),default:s(()=>[(p(!0),_(B,null,J(r.values,(i,u)=>(p(),L(te,{key:u,rounded:"lg"},{default:s(()=>[m(pe,{class:"name"},{default:s(()=>[w(g(u),1)]),_:2},1024),D("div",null,g(i),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Ne=de($e,[["render",De],["__scopeId","data-v-602996ad"]]);function y(){}y.prototype={diff:function(e,n){var a,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=l.callback;typeof l=="function"&&(r=l,l={});var i=this;function u(c){return c=i.postProcess(c,l),r?(setTimeout(function(){r(c)},0),!0):c}e=this.castInput(e,l),n=this.castInput(n,l),e=this.removeEmpty(this.tokenize(e,l)),n=this.removeEmpty(this.tokenize(n,l));var o=n.length,d=e.length,f=1,v=o+d;l.maxEditLength!=null&&(v=Math.min(v,l.maxEditLength));var V=(a=l.timeout)!==null&&a!==void 0?a:1/0,T=Date.now()+V,h=[{oldPos:-1,lastComponent:void 0}],C=this.extractCommon(h[0],n,e,0,l);if(h[0].oldPos+1>=d&&C+1>=o)return u(ie(i,h[0].lastComponent,n,e,i.useLongestToken));var z=-1/0,E=1/0;function M(){for(var c=Math.max(z,-f);c<=Math.min(E,f);c+=2){var $=void 0,x=h[c-1],I=h[c+1];x&&(h[c-1]=void 0);var P=!1;if(I){var K=I.oldPos-c;P=I&&0<=K&&K<o}var ee=x&&x.oldPos+1<d;if(!P&&!ee){h[c]=void 0;continue}if(!ee||P&&x.oldPos<I.oldPos?$=i.addToPath(I,!0,!1,0,l):$=i.addToPath(x,!1,!0,1,l),C=i.extractCommon($,n,e,c,l),$.oldPos+1>=d&&C+1>=o)return u(ie(i,$.lastComponent,n,e,i.useLongestToken));h[c]=$,$.oldPos+1>=d&&(E=Math.min(E,c-1)),C+1>=o&&(z=Math.max(z,c+1))}f++}if(r)(function c(){setTimeout(function(){if(f>v||Date.now()>T)return r();M()||c()},0)})();else for(;f<=v&&Date.now()<=T;){var N=M();if(N)return N}},addToPath:function(e,n,a,l,r){var i=e.lastComponent;return i&&!r.oneChangePerToken&&i.added===n&&i.removed===a?{oldPos:e.oldPos+l,lastComponent:{count:i.count+1,added:n,removed:a,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+l,lastComponent:{count:1,added:n,removed:a,previousComponent:i}}},extractCommon:function(e,n,a,l,r){for(var i=n.length,u=a.length,o=e.oldPos,d=o-l,f=0;d+1<i&&o+1<u&&this.equals(a[o+1],n[d+1],r);)d++,o++,f++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!r.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=o,d},equals:function(e,n,a){return a.comparator?a.comparator(e,n):e===n||a.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],a=0;a<e.length;a++)e[a]&&n.push(e[a]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ie(t,e,n,a,l){for(var r=[],i;e;)r.push(e),i=e.previousComponent,delete e.previousComponent,e=i;r.reverse();for(var u=0,o=r.length,d=0,f=0;u<o;u++){var v=r[u];if(v.removed)v.value=t.join(a.slice(f,f+v.count)),f+=v.count;else{if(!v.added&&l){var V=n.slice(d,d+v.count);V=V.map(function(T,h){var C=a[f+h];return C.length>T.length?C:T}),v.value=t.join(V)}else v.value=t.join(n.slice(d,d+v.count));d+=v.count,v.added||(f+=v.count)}}return r}function le(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function ue(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function Q(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function X(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function A(t,e){return Q(t,e,"")}function R(t,e){return X(t,e,"")}function oe(t,e){return e.slice(0,Le(t,e))}function Le(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var a=e.length;t.length<e.length&&(a=t.length);var l=Array(a),r=0;l[0]=0;for(var i=1;i<a;i++){for(e[i]==e[r]?l[i]=l[r]:l[i]=r;r>0&&e[i]!=e[r];)r=l[r];e[i]==e[r]&&r++}r=0;for(var u=n;u<t.length;u++){for(;r>0&&t[u]!=e[r];)r=l[r];t[u]==e[r]&&r++}return r}var F="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",_e=new RegExp("[".concat(F,"]+|\\s+|[^").concat(F,"]"),"ug"),U=new y;U.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};U.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(r){return r.segment})}else n=t.match(_e)||[];var a=[],l=null;return n.forEach(function(r){/\s/.test(r)?l==null?a.push(r):a.push(a.pop()+r):/\s/.test(l)?a[a.length-1]==l?a.push(a.pop()+r):a.push(l+r):a.push(r),l=r}),a};U.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};U.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,a=null,l=null;return t.forEach(function(r){r.added?a=r:r.removed?l=r:((a||l)&&se(n,l,a,r),n=r,a=null,l=null)}),(a||l)&&se(n,l,a,null),t};function se(t,e,n,a){if(e&&n){var l=e.value.match(/^\s*/)[0],r=e.value.match(/\s*$/)[0],i=n.value.match(/^\s*/)[0],u=n.value.match(/\s*$/)[0];if(t){var o=le(l,i);t.value=X(t.value,i,o),e.value=A(e.value,o),n.value=A(n.value,o)}if(a){var d=ue(r,u);a.value=Q(a.value,u,d),e.value=R(e.value,d),n.value=R(n.value,d)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),a&&(a.value=a.value.replace(/^\s*/,""));else if(t&&a){var f=a.value.match(/^\s*/)[0],v=e.value.match(/^\s*/)[0],V=e.value.match(/\s*$/)[0],T=le(f,v);e.value=A(e.value,T);var h=ue(A(f,T),V);e.value=R(e.value,h),a.value=Q(a.value,f,h),t.value=X(t.value,f,f.slice(0,f.length-h.length))}else if(a){var C=a.value.match(/^\s*/)[0],z=e.value.match(/\s*$/)[0],E=oe(z,C);e.value=R(e.value,E)}else if(t){var M=t.value.match(/\s*$/)[0],N=e.value.match(/^\s*/)[0],c=oe(M,N);e.value=A(e.value,c)}}var ke=new y;ke.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(F,"]+|[^\\S\\n\\r]+|[^").concat(F,"]"),"ug");return t.match(e)||[]};var S=new y;S.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],a=t.split(/(\n|\r\n)/);a[a.length-1]||a.pop();for(var l=0;l<a.length;l++){var r=a[l];l%2&&!e.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};S.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),y.prototype.equals.call(this,t,e,n)};var ze=new y;ze.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ee=new y;Ee.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function b(t){"@babel/helpers - typeof";return b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(t)}var k=new y;k.useLongestToken=!0;k.tokenize=S.tokenize;k.castInput=function(t,e){var n=e.undefinedReplacement,a=e.stringifyReplacer,l=a===void 0?function(r,i){return typeof i>"u"?n:i}:a;return typeof t=="string"?t:JSON.stringify(j(t,null,null,l),l,"  ")};k.equals=function(t,e,n){return y.prototype.equals.call(k,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function fe(t,e,n){return k.diff(t,e,n)}function j(t,e,n,a,l){e=e||[],n=n||[],a&&(t=a(l,t));var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return n[r];var i;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),i=new Array(t.length),n.push(i),r=0;r<t.length;r+=1)i[r]=j(t[r],e,n,a,l);return e.pop(),n.pop(),i}if(t&&t.toJSON&&(t=t.toJSON()),b(t)==="object"&&t!==null){e.push(t),i={},n.push(i);var u=[],o;for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&u.push(o);for(u.sort(),r=0;r<u.length;r+=1)o=u[r],i[o]=j(t[o],e,n,a,o);e.pop(),n.pop()}else i=t;return i}var W=new y;W.tokenize=function(t){return t.slice()};W.join=W.removeEmpty=function(t){return t};const xe={props:{modelValue:{type:Boolean,required:!0},current:{type:Object,required:!0},load:{type:Function,required:!0}},emit:["update:modelValue","use","revert"],data:()=>({list:[],latest:null,loading:!1,show:!1}),computed:{versions(){return this.list.filter(t=>this.isModified(t,this.current)||t.published||t.publish_at)}},methods:{diff(t,e){return t&&e?fe(t,e):e?[e]:[]},isModified(t,e){return!t||!e?!1:fe(t.data||{},e.data||{}).length!==1},reset(){this.list=[],this.latest=null}},watch:{modelValue:{immediate:!0,handler(t){t&&!this.latest&&(this.loading=!0,this.load().then(e=>{this.latest=e.shift(),this.list=e}).finally(()=>{this.loading=!1}))}}}},Ie={class:"loading"},Oe=["onClick"];function Ae(t,e,n,a,l,r){return p(),L(ye,{modelValue:n.modelValue,"max-width":"1200",scrollable:""},{default:s(()=>[m(H,{"prepend-icon":"mdi-history"},{append:s(()=>[m(G,{title:t.$gettext("Close"),onClick:e[0]||(e[0]=i=>t.$emit("update:modelValue",!1)),icon:"mdi-close",variant:"flat"},null,8,["title"])]),title:s(()=>[w(g(t.$gettext("History")),1)]),default:s(()=>[m(Ce),m(Z,null,{default:s(()=>[m(Te,{side:"end",align:"start"},{default:s(()=>[t.loading?(p(),L(q,{key:0,"dot-color":"grey-lighten-1",size:"small",width:"100%"},{default:s(()=>[D("div",Ie,[w(g(t.$gettext("Loading"))+" ",1),e[3]||(e[3]=D("svg",{class:"spinner",width:"32",height:"32",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[D("circle",{class:"spin1",cx:"4",cy:"12",r:"3"}),D("circle",{class:"spin1 spin2",cx:"12",cy:"12",r:"3"}),D("circle",{class:"spin1 spin3",cx:"20",cy:"12",r:"3"})],-1))])]),_:1})):Y("",!0),!t.loading&&!(t.latest&&r.isModified(t.latest,n.current)||r.versions.length)?(p(),L(q,{key:1,"dot-color":"grey-lighten-1",width:"100%",size:"small"},{default:s(()=>[w(g(t.$gettext("No changes")),1)]),_:1})):Y("",!0),!t.loading&&t.latest&&r.isModified(t.latest,n.current)?(p(),L(q,{key:2,"dot-color":"blue",width:"100%",size:"small"},{default:s(()=>[m(H,{class:"elevation-2",onClick:e[2]||(e[2]=i=>t.show=!t.show)},{default:s(()=>[m(ne,null,{default:s(()=>[w(g(t.$gettext("Current")),1)]),_:1}),m(Z,{class:O(["diff",{show:t.show}])},{default:s(()=>{var i;return[(p(!0),_(B,null,J(r.diff(n.current.data,(i=t.latest)==null?void 0:i.data),u=>(p(),_("span",{class:O({added:u.added,removed:u.removed})},g(u.value||u),3))),256))]}),_:1},8,["class"]),m(re,null,{default:s(()=>[m(G,{variant:"outlined",onClick:e[1]||(e[1]=ae(i=>t.$emit("revert",t.latest),["stop"]))},{default:s(()=>[w(g(t.$gettext("Revert")),1)]),_:1})]),_:1})]),_:1})]),_:1})):Y("",!0),(p(!0),_(B,null,J(r.versions,(i,u)=>(p(),L(q,{key:u,"dot-color":i.published?"success":"grey-lighten-1",class:O({publish:i.publish_at}),width:"100%",size:"small"},{default:s(()=>[m(H,{class:"elevation-2"},{default:s(()=>[D("div",{onClick:o=>i._show=!i._show},[m(ne,null,{default:s(()=>[w(g(new Date(i.publish_at||i.created_at).toLocaleString(t.$vuetify.locale.current)),1)]),_:2},1024),m(Ve,null,{default:s(()=>[w(g(i.editor),1)]),_:2},1024),m(Z,{class:O(["diff",{show:i._show}])},{default:s(()=>[(p(!0),_(B,null,J(r.diff(i.data,n.current.data),o=>(p(),_("span",{class:O({added:o.removed,removed:o.added})},g(o.value||o),3))),256))]),_:2},1032,["class"])],8,Oe),m(re,null,{default:s(()=>[m(G,{variant:"outlined",onClick:ae(o=>t.$emit("use",i),["stop"])},{default:s(()=>[w(g(t.$gettext("Use version")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["dot-color","class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}const qe=de(xe,[["render",Ae],["__scopeId","data-v-264e7254"]]),Re=function(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",e=new Date("2025-01-01T00:00:00Z").getTime();let n=0;return function(){n=(n+1)%8;const a=(Date.now()-e)/256<<3|n;return Array.from({length:6},(l,r)=>{const i=a>>6*(5-r)&63;return t[r===0?i%52:i]}).join("")}}();async function Be(t){const e=new AudioContext,a=await(await fetch(t)).arrayBuffer(),l=await e.decodeAudioData(a),r=[];for(let u=0;u<l.numberOfChannels;u++)r.push(l.getChannelData(u));const i=new Worker(new URL(""+new URL("assets/worker-uYZwUMq5.js",import.meta.url).href,import.meta.url),{type:"module"});return new Promise(u=>{i.onmessage=o=>u(o.data),i.postMessage({channels:r,length:l.length,sampleRate:l.sampleRate},r.map(o=>o.buffer))})}export{Ne as A,qe as H,Re as a,Be as u};
